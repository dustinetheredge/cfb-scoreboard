<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Top 25 Live Scoreboard</title>
<style>
  body { margin:0; background:#111; color:#fff; font-family:Arial; }
  #status { padding:10px; background:#181818; border-bottom:1px solid #333; }
  #grid {
    display:grid;
    grid-template-columns:repeat(6,1fr);
    gap:12px;
    padding:20px;
  }
  .card { background:#1e1e1e; padding:12px; border-radius:10px; }
  .team { display:flex; justify-content:space-between; }
  .meta { margin-top:6px; font-size:12px; opacity:0.7; }
  .live { color:#0f0; }
  .final { color:#f66; }
</style>
</head>

<body>

<div id="status">Loading Top 25 Scores…</div>
<div id="grid"></div>

<script>
async function loadScores() {
  try {
    document.getElementById("status").textContent = "Updating…";

    // ESPN core API (CORS SAFE)
    const url = "https://sports.core.api.espn.com/v2/sports/football/leagues/college-football/events?limit=250";

    const res = await fetch(url);
    const data = await res.json();

    const eventUrls = data.items.map(i => i.$ref);

    // Load each event
    const events = await Promise.all(eventUrls.map(u => fetch(u).then(r => r.json())));

    // Filter Top 25 teams
    const top25 = events.filter(ev =>
      ev.competitions[0].competitors.some(t => t.rank && t.rank <= 25)
    );

    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    top25.forEach(ev => {
      const comp = ev.competitions[0];
      const c1 = comp.competitors[0];
      const c2 = comp.competitors[1];

      const home = c1.homeAway === "home" ? c1 : c2;
      const away = c1.homeAway === "away" ? c1 : c2;

      const s = ev.status;
      let statusLabel = "";
      let statusClass = "";

      if (s.type === "in") {
        statusClass = "live";
        statusLabel = `${s.period}Q • ${s.clock}`;
      } else if (s.type === "post") {
        statusClass = "final";
        statusLabel = "Final";
      } else {
        statusLabel = new Date(ev.date).toLocaleTimeString([], { hour:"numeric", minute:"2-digit" });
      }

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="team">
          <span>${away.rank ? "#" + away.rank + " " : ""}${away.team.displayName}</span>
          <strong>${away.score ?? "-"}</strong>
        </div>
        <div class="team">
          <span>${home.rank ? "#" + home.rank + " " : ""}${home.team.displayName}</span>
          <strong>${home.score ?? "-"}</strong>
        </div>
        <div class="meta ${statusClass}">${statusLabel}</div>
      `;

      grid.appendChild(card);
    });

    document.getElementById("status").textContent =
      `Top 25 Scoreboard (${top25.length} games)`;

  } catch (err) {
    console.error(err);
    document.getElementById("status").textContent = "Error loading scores";
  }
}

loadScores();
setInterval(loadScores, 15000);
</script>

</body>
</html>
