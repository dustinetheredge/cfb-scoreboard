<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Top 25 Scoreboard</title>

<style>
  body { margin:0; background:#111; color:#fff; font-family:Arial; }
  h2 { padding:12px; margin:0; }
  #grid {
    display:grid;
    grid-template-columns:repeat(6,1fr);
    gap:12px;
    padding:12px;
  }
  .card {
    background:#1e1e1e;
    padding:12px;
    border-radius:10px;
  }
  .team { display:flex; justify-content:space-between; font-size:16px; }
  .meta { margin-top:6px; font-size:12px; opacity:0.7; }
  .live { color:#0f0; font-weight:bold; }
  .final { color:#f55; }
</style>
</head>

<body>

<h2>Top 25 Scoreboard</h2>
<div id="grid"></div>

<script>
// JSONP loader
function loadJSONP(url) {
  return new Promise(resolve => {
    const cb = "cb" + Math.floor(Math.random()*99999);
    window[cb] = data => resolve(data);
    const script = document.createElement("script");
    script.src = url + "?callback=" + cb;   // IMPORTANT
    document.body.appendChild(script);
  });
}

async function loadScores() {
  const url = "https://site.api.espn.com/apis/v2/sports/football/college-football/scoreboard";
  const data = await loadJSONP(url);

  const events = data.events || [];

  const top25 = events.filter(ev =>
    ev.competitions[0].competitors.some(t => t.rank && t.rank <= 25)
  );

  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  top25.forEach(ev => {
    const comp = ev.competitions[0];
    const c1 = comp.competitors[0];
    const c2 = comp.competitors[1];

    const home = c1.homeAway === "home" ? c1 : c2;
    const away = c1.homeAway === "away" ? c1 : c2;

    let statusClass = "";
    let statusLabel = "";
    
    const s = ev.status;

    if (s.type.name === "STATUS_IN_PROGRESS") {
      statusClass = "live";
      statusLabel = `${s.period}Q ${s.displayClock}`;
    } else if (s.type.name === "STATUS_FINAL") {
      statusClass = "final";
      statusLabel = "Final";
    } else {
      statusLabel = new Date(ev.date).toLocaleTimeString([], {hour:"numeric", minute:"2-digit"});
    }

    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="team">
        <span>${away.rank ? "#" + away.rank + " " : ""}${away.team.displayName}</span>
        <strong>${away.score ?? "-"}</strong>
      </div>
      <div class="team">
        <span>${home.rank ? "#" + home.rank + " " : ""}${home.team.displayName}</span>
        <strong>${home.score ?? "-"}</strong>
      </div>
      <div class="meta ${statusClass}">${statusLabel}</div>
    `;
    grid.appendChild(card);
  });
}

loadScores();
setInterval(loadScores, 15000);
</script>

</body>
</html>
